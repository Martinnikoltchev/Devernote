<!DOCTYPE HTML>
<html>
    <head>
        <!-- Javascript Files -->
        <script type="text/javascript" src="../static/js/jquery-2.1.1.min.js"></script>
        <script type="text/javascript" src="../static/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="../static/js/codemirror.js"></script>
        <script type="text/javascript" src="../static/js/python.js"></script>
        <script type="text/javascript" src="../static/js/jquery-ui.min.js"></script>

        <!-- CSS Files -->
        <link rel="stylesheet" type="text/css" href="../static/css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="../static/css/bootstrap-theme.min.css" />
        <link rel="stylesheet" type="text/css" href="../static/css/codemirror.css" />
        <link rel="stylesheet" type="text/css" href="../static/css/jquery-ui.min.css">
        <link rel="stylesheet" type="text/css" href="../static/css/jquery-ui.theme.min.css">
        <link rel="stylesheet" type="text/css" href="../static/css/jquery-ui.structure.min.css">

        <style>
        #editorDiv{
            margin: 10px 10px 50px 10px;
            border-top:1px solid #AAA;
            border-bottom:1px solid #AAA;
        }
        a{
            color:black;
        }
        a:hover{
            text-decoration: none;
        }
        h1, button{
            margin-left:10px;
        }
        #output_results{
            margin: 0px 0px 50px 10px;
            padding-top:10px;
            padding-bottom:10px;
            width:98.5%;
            border-bottom: 1px solid;
            border-top: 1px solid;
            border-color: #C0C0C0;
            margin-top:5px;
        }
        </style>
    </head>
    <body>
        <div id="popupbox" title="Upload File(s)"></div>
        <script type="text/javascript">
            $(document).ready(function(){

                $('#output_div').hide();

                $('.popup').click(function(e){
                    e.preventDefault();
                    $("#popupbox").load($(this).attr("href"), function(){
                         //sets popup box to be at the top and have a certain width
                        $("#popupbox").dialog({
                            autoOpen: false,
                            width:450,
                        });
                        $("#popupbox").dialog("open");   
                        $(".closedialog").click(function(e){
                            e.preventDefault();
                            $("#popupbox").dialog("close");
                            return false;
                        });    
                    });
                    return false;
                });

                $("#save_content").click(function(e){
                    e.preventDefault();
                    var text_data = editor.getValue();
                    $.ajax({
                        type:"POST",
                        url:"../models/pycomp.php",
                        data: {"content": text_data},
                        dataType:"json",
                        success:function(data){
                            $('#output_div').show();
                            console.log('Content posted.');
                            console.log(data);
                        },
                        error:function(err){
                            console.log(err);
                        }
                    });
                });
            });

        </script>
        <nav class = "navbar navbar-default" role="navigation">
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li><a class="navbar-brand" href="../index.php">Devernote</a></li>
                    <li><a href="browser.html">Projects</a></li>
                    <li><a href="work.html">Text Editor</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="login.html">Login</a></li>
                </ul>
            </div>
        </nav>

        <div id="content_container">
            <h1>Text Editor</h1>
            <div id="editorDiv">
                <textarea id="textEditor"># your code goes here</textarea>
                <script type="text/javascript">
                var editor = CodeMirror.fromTextArea(document.getElementById("textEditor"),{
                    mode: "python"
                });
                </script>
            </div>
            <div id="output_div">
                <h1>Output</h1>
                <p id="output_results">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                </p>
            </div>
            <button class = "btn btn-default" id="save_content">Save</button>
            <button class = "btn btn-default"><a href="../templates/popup.html" class="popup">Upload File</a></button>
        </div>
    </body>
</html>